# 6.第一个深度神经网络：反向传播

## 6.3 矩阵和矩阵关系

- Rules

  - 惯例是用一行来表示每个样例记录，每一列表示每一项（属性）

    <!--比如第一列是脚趾头数量，第二列是胜负记录，第三列是粉丝数量。而每一行都是这三个属性的一个样例记录-->

- Implementation

  <!--学习交通信号灯停止和通行-->

  ```python
  import numpy as np
  
  weights = np.array([0.5, 0.48, -0.7])
  alpha = 0.1
  
  # Training data
  streetlights = np.array([
      [1, 0, 1],
      [0, 1, 1],
      [0, 0, 1],
      [1, 1, 1],
      [0, 1, 1],
      [1, 0, 1]])
  walk_vs_stop = np.array([0, 1, 0, 1, 1, 0])
  
  # Training
  for iter in range(40):
      error_for_all_lights = 0
      for row_index in range(len(walk_vs_stop)):
          input = streetlights[row_index]
          goal_prediction = walk_vs_stop[row_index]
  
          prediction = input.dot(weights)
  
          error = (prediction - goal_prediction) ** 2
          error_for_all_lights += error
  
          delta = prediction - goal_prediction
          weights = weights - (alpha * (input * delta))
          print("Prediction:" + str(prediction))
      print("Error:" + str(error_for_all_lights) + "\n")
  ```

  ```shell
  # Analyse
  1.思路
  	1.设置权重和学习率
  	2.输入训练数据，包括总灯上的三种信号灯分别是亮或暗属性，以及停止还是通行的记录
  	3.设计第一层循环，用于设置训练次数；用变量存储总error值
  	4.设计第二层循环
  	5.给input和goal_prediction赋值
  	6.通过input和weights求的预测的值
  	7.计算erroe，并累加总error
  	8.调整weights
  	9.重新开始循环
  ```

  ```shell
  # output
  Prediction:-0.0022410273814405524
  Prediction:0.9978745386023716
  Prediction:-0.016721264429884947
  Prediction:1.0151127459893812
  Prediction:0.9969492081270097
  Prediction:-0.0026256193329783125
  Error:0.00053373677328488
  ```

> 感觉神经网络，就是聚类和分类，计算属于某个类的可能性，来最小化误差

## 6.7 完全、批量和随机梯度下降

### 随机梯度下降

- Definition：针对每个执行样例执行预测和更新权重。

  <!--和6.3中的implementation一样-->

### 完全梯度下降

- Definition：针对整个训练集计算weight_delta的平均值，使用平均值来更新权重。

  <!--不同于6.3中的implementation-->

### 批量梯度下降

- Definition：自定义批次大小的样例，再更新权重。

  <!--比如，选择8个样例之后更新一次权重-->



















